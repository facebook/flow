"use strict";(globalThis.webpackChunknew_website=globalThis.webpackChunknew_website||[]).push([[3446],{33446(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"strict/index","title":"Flow Strict","description":"Learn how to enable stricter type checking on a file-by-file basis.","source":"@site/docs/strict/index.md","sourceDirName":"strict","slug":"/strict","permalink":"/en/docs/strict","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/flow/edit/main/website/docs/strict/index.md","tags":[],"version":"current","frontMatter":{"title":"Flow Strict","slug":"/strict","description":"Learn how to enable stricter type checking on a file-by-file basis."},"sidebar":"docsSidebar","previous":{"title":"Lint Rule Reference","permalink":"/en/docs/linting/rule-reference"},"next":{"title":"Flow CLI","permalink":"/en/docs/cli"}}');var r=t(74848),o=t(28453);const s={title:"Flow Strict",slug:"/strict",description:"Learn how to enable stricter type checking on a file-by-file basis."},l=void 0,c={},a=[{value:"Overview",id:"toc-overview",level:3},{value:"Features",id:"toc-features",level:3},{value:"Enabling Flow Strict in a .flowconfig",id:"toc-enabling-flow-strict-in-a-flowconfig",level:3},{value:"Adoption",id:"toc-adoption",level:3},{value:"Strict Local",id:"toc-strict-local",level:3},{value:"What&#39;s Ahead",id:"toc-what-s-ahead",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["You can enable stronger safety guarantees in Flow (such as banning ",(0,r.jsx)(n.code,{children:"any"}),"/",(0,r.jsx)(n.code,{children:"Object"}),"/",(0,r.jsx)(n.code,{children:"Function"})," types and requiring all dependencies to be typed) by adding ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:"@flow strict"})})," to your files."]}),"\n",(0,r.jsx)(n.h3,{id:"toc-overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["Flow was designed for easy adoption, so it allows you opt-out of type checking in certain situations, permitting unsafe behaviors. But since many codebases now have a high adoption of Flow types, this trade-off can be flipped.  You can use ",(0,r.jsx)(n.em,{children:"Flow Strict"})," to disallow previously-allowed unsafe patterns. This gives you improved safety guarantees that catch more bugs and make refactoring easier. And you can implement these stronger guarantees incrementally, on a file-by-file basis."]}),"\n",(0,r.jsx)(n.h3,{id:"toc-features",children:"Features"}),"\n",(0,r.jsxs)(n.p,{children:["Enabling Flow Strict for a file means that several previously-allowed patterns will now trigger a Flow error. Each disallowed pattern has a corresponding ",(0,r.jsx)(n.a,{href:"../linting/",children:"Flow Lint"})," rule which triggers the error. The list of rules enabled for ",(0,r.jsx)(n.code,{children:"@flow strict"})," is configured in each ",(0,r.jsx)(n.code,{children:".flowconfig"}),". Here are the recommended rules:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-nonstrict-import",children:(0,r.jsx)(n.code,{children:"nonstrict-import"})}),": Triggers an error when importing from a module which is not also ",(0,r.jsx)(n.code,{children:"@flow strict"}),". This is very important, because it means that when a file is marked as strict, all of its dependencies are strict as well."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-unclear-type",children:(0,r.jsx)(n.code,{children:"unclear-type"})}),": Triggers an error when using ",(0,r.jsx)(n.code,{children:"Object"}),", ",(0,r.jsx)(n.code,{children:"Function"}),", or ",(0,r.jsx)(n.code,{children:"any"})," in a type annotation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-untyped-import",children:(0,r.jsx)(n.code,{children:"untyped-import"})}),": Triggers an error when importing from an untyped module."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-untyped-type-import",children:(0,r.jsx)(n.code,{children:"untyped-type-import"})}),": Triggers an error when importing a type from an untyped module."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-unsafe-getters-setters",children:(0,r.jsx)(n.code,{children:"unsafe-getters-setters"})}),": Triggers an error when using getters and setters, which can be unsafe."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../linting/rule-reference/#toc-sketchy-null",children:(0,r.jsx)(n.code,{children:"sketchy-null"})}),": Triggers an error when doing an existence check on a value that could be null/undefined or falsey."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For a full list of available lint rules, see the ",(0,r.jsx)(n.a,{href:"../linting/rule-reference/",children:"Lint Rule Reference"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Additionally, note that function parameters are considered const (i.e., treated as if they were declared with ",(0,r.jsx)(n.code,{children:"const"})," rather than ",(0,r.jsx)(n.code,{children:"let"}),"). This feature is not yet configurable in Flow Strict; it is always on."]}),"\n",(0,r.jsx)(n.h3,{id:"toc-enabling-flow-strict-in-a-flowconfig",children:"Enabling Flow Strict in a .flowconfig"}),"\n",(0,r.jsxs)(n.p,{children:["Flow Strict is configured in each ",(0,r.jsx)(n.code,{children:".flowconfig"}),". To enable:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Add a ",(0,r.jsx)(n.code,{children:"[strict]"})," section to the ",(0,r.jsx)(n.code,{children:".flowconfig"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"List the lint rules to enable . These are strongly recommended:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-text",children:"[strict]\nnonstrict-import\nunclear-type\nunsafe-getters-setters\nuntyped-import\nuntyped-type-import\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Also recommended, but optional as it may be too noisy in some codebases:\n",(0,r.jsx)(n.code,{children:"sketchy-null"})]}),"\n",(0,r.jsxs)(n.p,{children:["We recommend you enable all your desired rules from the beginning, then adopt Flow Strict file-by-file. This works better than enabling a single rule, adding ",(0,r.jsx)(n.code,{children:"@flow strict"})," to many files, and then adding more rules to the config."]}),"\n",(0,r.jsx)(n.h3,{id:"toc-adoption",children:"Adoption"}),"\n",(0,r.jsxs)(n.p,{children:["Add ",(0,r.jsx)(n.code,{children:"@flow strict"})," to a file and fix all errors that appear. Because Flow Strict requires dependencies to also be strict (if the ",(0,r.jsx)(n.code,{children:"nonstrict-import"})," rule is enabled), start at the leaves of the dependency tree and work up from there. Do not add ",(0,r.jsx)(n.code,{children:"$FlowFixMe"})," to suppress the new errors as they appear; just add ",(0,r.jsx)(n.code,{children:"@flow strict"})," once all issues have been resolved. Since the most common reasons for using ",(0,r.jsx)(n.code,{children:"$FlowFixMe"})," stem from reliance on untyped dependencies or behavior, future issues should be greatly reduced once Flow Strict is enabled."]}),"\n",(0,r.jsxs)(n.p,{children:["Be liberal with enabling Flow Strict. Unlike adding or removing ",(0,r.jsx)(n.code,{children:"@flow"}),", adding or removing ",(0,r.jsx)(n.code,{children:"@flow strict"})," (by itself) does not change Flow coverage. It only prevents or allows certain new unsafe behavior from being added in the future. Even if in the future Flow Strict has to be disabled for the file, at least unsafe behavior was prevented from being added in the meantime."]}),"\n",(0,r.jsx)(n.p,{children:"Library definitions are considered strict (as they can be included in many different projects with contradicting strict configurations)."}),"\n",(0,r.jsx)(n.h3,{id:"toc-strict-local",children:"Strict Local"}),"\n",(0,r.jsxs)(n.p,{children:["If you enable the ",(0,r.jsx)(n.code,{children:"nonstrict-import"})," rule in your Flow Strict configuration (recommended), then all dependencies of a strict file must also be strict. While this the optimal goal, for large pre-existing codebases it may be beneficial to allow some of the benefits of Flow Strict to be put in use before all dependencies are strict."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"@flow strict-local"})," is the same as ",(0,r.jsx)(n.code,{children:"@flow strict"}),', except it does not require its dependencies to also be strict (i.e. it is "locally" strict). It does not have a separate configuration: it uses the same configuration as Flow Strict, just without the ',(0,r.jsx)(n.code,{children:"nonstrict-import"})," rule."]}),"\n",(0,r.jsxs)(n.p,{children:["Once all the dependencies of a ",(0,r.jsx)(n.code,{children:"@flow strict-local"})," file are strict, the file can be upgraded to a ",(0,r.jsx)(n.code,{children:"@flow strict"})," file. A ",(0,r.jsx)(n.code,{children:"@flow strict"})," file cannot depend on a ",(0,r.jsx)(n.code,{children:"@flow strict-local"})," file as this would break the ",(0,r.jsx)(n.code,{children:"nonstrict-import"})," rule."]}),"\n",(0,r.jsx)(n.h3,{id:"toc-what-s-ahead",children:"What's Ahead"}),"\n",(0,r.jsx)(n.p,{children:"Eventually, some features of Flow Strict could become the default behavior of Flow, if those features prove successful and achieve widespread adoption."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453(e,n,t){t.d(n,{R:()=>s,x:()=>l});var i=t(96540);const r={},o=i.createContext(r);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);